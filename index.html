<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mental Math Trainer Pro - The Basics</title>
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="style.css">
    <!-- Link to Chart.js library -->
    <script src="chart/dist/chart.umd.js"></script>
    <!-- Link to Tone.js library for sound generation -->
    <script src="Tone.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <nav class="sidebar" id="sidebar">
            <button class="sidebar-toggle" id="sidebarToggle">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/>
                </svg>
            </button>
            
            <div class="logo">
                <h1>Mental Math Trainer Pro</h1>
                <p>The Basics</p>
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="#" class="nav-link active tooltip" data-page="dashboard" data-tooltip="Dashboard">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8v-6h-8v10zm0-18v6h8V3h-8z"/>
                        </svg>
                        <span class="nav-text">Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link tooltip" data-page="settings" data-tooltip="Settings">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
                        </svg>
                        <span class="nav-text">Advanced Settings</span>
                    </a>
                </li>
                <!-- New GitHub Link -->
                <li class="nav-item">
                    <a href="#" class="nav-link tooltip" data-page="github" data-tooltip="GitHub">
                        <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.835 2.809 1.305 3.493.998.108-.776.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576C20.566 21.797 24 17.3 24 12c0-6.627-5.373-12-12-12z"/>
                        </svg>
                        <span class="nav-text">GitHub</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <nav class="breadcrumb">
                    <a href="#" class="breadcrumb-item active">Dashboard</a>
                </nav>

                <div class="page-header">
                    <h1 class="page-title">Dashboard</h1>
                    <p class="page-subtitle">Track your progress and start your mental math training</p>
                </div>

                <!-- Performance Stats with Circular Progress -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="circular-progress">
                            <svg>
                                <circle class="progress-ring" cx="40" cy="40" r="32"></circle>
                                <circle class="progress-fill" cx="40" cy="40" r="32" stroke-dasharray="201.06" stroke-dashoffset="40.21"></circle>
                            </svg>
                            <div class="progress-text" id="problemsSolvedCount">0</div>
                        </div>
                        <div class="stat-label">Problems Solved</div>
                    </div>
                    <div class="stat-card">
                        <div class="circular-progress">
                            <svg>
                                <circle class="progress-ring" cx="40" cy="40" r="32"></circle>
                                <circle class="progress-fill" cx="40" cy="40" r="32" stroke-dasharray="201.06" stroke-dashoffset="12.06"></circle>
                            </svg>
                            <div class="progress-text">94%</div>
                        </div>
                        <div class="stat-label">Accuracy Rate</div>
                    </div>
                    <div class="stat-card">
                        <div class="circular-progress">
                            <svg>
                                <circle class="progress-ring" cx="40" cy="40" r="32"></circle>
                                <circle class="progress-fill" cx="40" cy="40" r="32" stroke-dasharray="201.06" stroke-dashoffset="120.64"></circle>
                            </svg>
                            <div class="progress-text">2.3s</div>
                        </div>
                        <div class="stat-label">Avg Response Time</div>
                    </div>
                    <!-- Quick Start Card moved here and modified -->
                    <div class="stat-card">
                        <div class="stat-icon"> <!-- Changed from circular-progress -->
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="var(--primary-color)">
                                <!-- Standard checkmark path -->
                                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                            </svg>
                        </div>
                        <div class="stat-label">Quick Start</div>
                        <button class="stat-card-action" id="startPracticeBtn">Start</button>
                    </div>
                </div>

                <!-- Main Cards -->
                <div class="cards-grid">
                    <!-- Recent Performance Card re-added with new structure -->
                    <div class="card recent-sessions-card">
                        <div class="card-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="white">
                                <path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.51 0-2.91-.49-4.06-1.3l-1.42 1.42C9.4 19.5 11.13 20 13 20c4.97 0 9-4.03 9-9s-4.03-9-9-9z"/>
                            </svg>
                        </div>
                        <h3 class="card-title">Recent Performance</h3>
                        <p class="card-description">Overview of your last few training sessions.</p>

                        <div id="recentSessionsContainer" class="recent-sessions-list">
                            <!-- Date-grouped micro cards will be dynamically inserted here by JavaScript -->
                            <p style="text-align: center; color: var(--text-secondary);">No recent sessions yet. Start a practice session!</p>
                        </div>
                        <div id="paginationControls" class="pagination-controls">
                            <!-- Pagination buttons will be dynamically inserted here by JavaScript -->
                        </div>
                    </div>
                    <!-- Removed Custom Practice Card -->
                </div>
            </div>

            <!-- Advanced Settings Page -->
            <div id="settings" class="page">
                <nav class="breadcrumb">
                    <a href="#" class="breadcrumb-item" onclick="switchPage('dashboard')">Dashboard</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <span class="breadcrumb-item active">Settings</span>
                </nav>

                <div class="page-header">
                    <h1 class="page-title">Advanced Settings</h1>
                    <p class="page-subtitle">Customize your mental math training experience</p>
                </div>

                <!-- Settings Tabs -->
                <div class="settings-tabs">
                    <button class="tab-btn active" data-tab="general">General</button>
                    <button class="tab-btn" data-tab="performance">Performance</button>
                    <button class="tab-btn" data-tab="theme">Theme</button>
                </div>

                <!-- General Tab -->
                <div id="general" class="tab-content active">
                    <div class="settings-section">
                        <h3 class="settings-title">Practice Mode</h3>
                        <div class="setting-item">
                            <label class="practice-mode-option">
                                <input type="radio" name="practiceMode" value="timed" id="practiceModeTimed">
                                Timed Practice
                                <input type="number" value="5" min="1" id="timedMinutes"> Minutes
                            </label>
                        </div>
                        <div class="setting-item">
                            <label class="practice-mode-option">
                                <input type="radio" name="practiceMode" value="fixed" id="practiceModeFixed">
                                Fixed Quantity
                                <input type="number" value="25" min="1" id="fixedProblems"> Problems
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="settings-title">Operation Types</h3>
                        <div class="setting-item operation-item" data-operation="addition">
                            <span class="setting-label">Addition</span>
                            <div class="operation-controls">
                                <span class="toggle-control" data-state="enabled">Enabled</span>
                                <span class="dropdown-trigger">Settings</span>
                            </div>
                            <div class="operation-dropdown">
                                <div class="dropdown-section">
                                    <label>Value Range For Operation</label>
                                    <div class="range-inputs">
                                        Start of Range <input type="number" value="1" class="range-start">
                                        End of Range <input type="number" value="100" class="range-end">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item operation-item" data-operation="subtract">
                            <span class="setting-label">Subtraction</span>
                            <div class="operation-controls">
                                <span class="toggle-control" data-state="enabled">Enabled</span>
                                <span class="dropdown-trigger">Settings</span>
                            </div>
                            <div class="operation-dropdown">
                                <div class="dropdown-section">
                                    <label>Always larger number first</label>
                                    <input type="checkbox" class="larger-first" checked>
                                </div>
                                <div class="dropdown-section">
                                    <label>Value Range For Operation</label>
                                    <div class="range-inputs">
                                        Start of Range <input type="number" value="1" class="range-start">
                                        End of Range <input type="number" value="100" class="range-end">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item operation-item" data-operation="multiply">
                            <span class="setting-label">Multiplication</span>
                            <div class="operation-controls">
                                <span class="toggle-control" data-state="enabled">Enabled</span>
                                <span class="dropdown-trigger">Settings</span>
                            </div>
                            <div class="operation-dropdown">
                                <div class="dropdown-section">
                                    <label>Value Range For Operation</label>
                                    <div class="range-inputs">
                                        Start of Range <input type="number" value="1" class="range-start">
                                        End of Range <input type="number" value="12" class="range-end">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="setting-item operation-item" data-operation="divide">
                            <span class="setting-label">Division</span>
                            <div class="operation-controls">
                                <span class="toggle-control" data-state="enabled">Enabled</span>
                                <span class="dropdown-trigger">Settings</span>
                            </div>
                            <div class="operation-dropdown">
                                <div class="dropdown-section">
                                    <label>Value Range For Operation</label>
                                    <div class="range-inputs">
                                        Start of Range <input type="number" value="1" class="range-start">
                                        End of Range <input type="number" value="100" class="range-end">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="settings-title">Operation Proportions</h3>
                        <canvas id="operationPieChart" style="max-width: 400px; margin: auto;"></canvas>
                        <p style="text-align: center; margin-top: 0.5rem; color: var(--text-secondary); font-size: 0.9rem;">Drag sliders below to adjust proportions (total must equal 100%)</p>
                        <div id="slidersContainer" style="max-width: 400px; margin: auto;"></div>
                    </div>
                </div>

                <!-- Performance Tab -->
                <div id="performance" class="tab-content">
                    <div class="settings-section">
                        <h3 class="settings-title">Audio & Feedback</h3>
                        <div class="setting-item">
                            <span class="setting-label">Success chime</span>
                            <span class="toggle-control" data-setting-id="successChime" data-state="enabled">Enabled</span>
                            <button id="testChimeBtn" style="margin-left: 10px; padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--primary-color); background: var(--primary-color); color: white; cursor: pointer;">Test Chime</button>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Error buzzer</span>
                            <span class="toggle-control" data-setting-id="errorBuzzer" data-state="enabled">Enabled</span>
                            <button id="testBuzzerBtn" style="margin-left: 10px; padding: 0.5rem 1rem; border-radius: 8px; border: 1px solid var(--primary-color); background: var(--primary-color); color: white; cursor: pointer;">Test Buzzer</button>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="settings-title">Problem Presentation Mode</h3>
                        <div class="setting-item">
                            <label class="practice-mode-option">
                                <input type="radio" name="problemPresentationMode" value="displayVisual" checked>
                                <div>
                                    Display visually, no speech or hiding.
                                    <p class="setting-subtitle" style="font-size: 0.85em; color: var(--text-secondary);">The most neutral visual-only mode</p>
                                </div>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label class="practice-mode-option">
                                <input type="radio" name="problemPresentationMode" value="displayBriefly" id="displayBrieflyRadio">
                                <div>
                                    Display briefly, then hide after <input type="number" id="briefDisplayDuration" value="2" min="1" class="setting-control"> seconds.
                                    <p class="setting-subtitle" style="font-size: 0.85em; color: var(--text-secondary);">For short-term visual memory testing</p>
                                </div>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label class="practice-mode-option">
                                <input type="radio" name="problemPresentationMode" value="speakAloud">
                                <div>
                                    Speak aloud, do not display visually.
                                    <p class="setting-subtitle" style="font-size: 0.85em; color: var(--text-secondary);">Audio-only mode for listening practice</p>
                                </div>
                            </label>
                        </div>
                        <div class="setting-item">
                            <label class="practice-mode-option">
                                <input type="radio" name="problemPresentationMode" value="displaySpeak">
                                <div>
                                    Display visually and speak aloud simultaneously.
                                    <p class="setting-subtitle" style="font-size: 0.85em; color: var(--text-secondary);">Maximizes clarity with both channels</p>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="settings-title">Timing Behavior</h3>
                        <div class="setting-item">
                            <span class="setting-label">Auto-submit on correct digits</span>
                            <span class="toggle-control" data-setting-id="autoSubmit" data-state="enabled">Enabled</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Mark incorrect if answering takes longer than</span>
                            <input type="number" value="3" min="1" class="setting-control" data-setting-id="maxResponseTime">&nbsp;seconds&nbsp;&nbsp;
                            <span class="toggle-control" data-setting-id="enableMaxResponseTime" data-state="enabled">Enabled</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Hide timer display during session</span>
                            <span class="toggle-control" data-setting-id="hideTimer" data-state="disabled">Disabled</span>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3 class="settings-title">Failure Conditions</h3>
                        <div class="setting-item">
                            <select class="setting-control" data-setting-id="failureAction" style="width: 120px;">
                                <option value="end">End</option>
                                <option value="restart">Restart</option>
                            </select>
                            <span class="setting-label" style="flex-basis: auto; margin-left: 10px;">session if&nbsp;</span>
                            <input type="number" value="3" min="1" class="setting-control" data-setting-id="maxMistakes">
                            <span class="setting-label" style="flex-basis: auto; margin-left: 5px;">mistakes are made&nbsp;&nbsp;&nbsp;&nbsp;</span>
                            <span class="toggle-control" data-setting-id="enableFailureCondition" data-state="disabled">Disabled</span>
                        </div>
                        <div class="setting-item">
                            <span class="setting-label">Retry Until Correct</span>
                            <span class="toggle-control" data-setting-id="retryUntilCorrect" data-state="disabled">Disabled</span>
                        </div>
                    </div>
                </div>

                <!-- Theme Tab Content -->
                <div class="tab-content" id="theme">
                    <section class="settings-section">
                        <h3 class="settings-title">Customize Colors</h3>
                        <p>Adjust the primary colors of the application to match your style.</p>
                        <div class="color-options-grid">
                            <div class="color-option">
                                <label for="primaryColor">Primary Color</label>
                                <input type="color" id="primaryColor" data-color-var="--primary-color">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="secondaryColor">Secondary Color</label>
                                <input type="color" id="secondaryColor" data-color-var="--secondary-color">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="bgColorPrimary">Background Primary</label>
                                <input type="color" id="bgColorPrimary" data-color-var="--bg-primary">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="bgColorSecondary">Background Secondary</label>
                                <input type="color" id="bgColorSecondary" data-color-var="--bg-secondary">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="textColorPrimary">Text Primary</label>
                                <input type="color" id="textColorPrimary" data-color-var="--text-primary">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="textColorSecondary">Text Secondary</label>
                                <input type="color" id="textColorSecondary" data-color-var="--text-secondary">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="glassBg">Glass Background</label>
                                <input type="color" id="glassBg" data-color-var="--glass-bg">
                                <span class="color-swatch"></span>
                            </div>
                             <div class="color-option">
                                <label for="glassBorder">Glass Border</label>
                                <input type="color" id="glassBorder" data-color-var="--glass-border">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="cardBg">Card Background</label>
                                <input type="color" id="cardBg" data-color-var="--card-bg">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="popupBgStart">Popup Background Start</label>
                                <input type="color" id="popupBgStart" data-color-var="--popup-bg-start">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="popupBgEnd">Popup Background End</label>
                                <input type="color" id="popupBgEnd" data-color-var="--popup-bg-end">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="popupBorder">Popup Border</label>
                                <input type="color" id="popupBorder" data-color-var="--popup-border">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="popupShadowColor">Popup Shadow Color</label>
                                <input type="color" id="popupShadowColor" data-color-var="--popup-shadow-color">
                                <span class="color-swatch"></span>
                            </div>
                            <div class="color-option">
                                <label for="popupAccentGlow">Popup Accent Glow</label>
                                <input type="color" id="popupAccentGlow" data-color-var="--popup-accent-glow">
                                <span class="color-swatch"></span>
                            </div>
                        </div>
                        <button class="btn btn-secondary mt-1" id="restoreDefaultColorsBtn">Reset to Defaults</button>
                    </section>
                </div>
                
                <!-- Save Settings Button -->
                <button class="save-settings-btn" id="saveSettingsBtn">Save Settings</button>
            </div>

            <!-- GitHub Page -->
            <div id="github" class="page">
                <nav class="breadcrumb">
                    <a href="#" class="breadcrumb-item" onclick="switchPage('dashboard')">Dashboard</a>
                    <span class="breadcrumb-separator">â€º</span>
                    <span class="breadcrumb-item active">GitHub</span>
                </nav>

                <div class="page-header">
                    <h1 class="page-title">GitHub</h1>
                    <p class="page-subtitle">Find the source code, releases, and contact information.</p>
                </div>

                <div class="settings-section">
                    <h3 class="settings-title">Repository & Releases</h3>
                    <div class="setting-item">
                        <span class="setting-label">Official GitHub Repo:</span>
                        <a href="https://github.com/MathTrainerPro/MentalMathTrainerPro/tree/main" target="_blank" class="setting-control">View Repository</a>
                    </div>
                    <div class="setting-item">
                        <span class="setting-label">Releases (Download Page):</span>
                        <a href="https://github.com/MathTrainerPro/MentalMathTrainerPro/releases" target="_blank" class="setting-control">Download Releases</a>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-title">ðŸ“¬ Contact</h3>
                    <p class="card-description">Found a bug or want to suggest a feature?</p>
                    <div class="setting-item">
                        <span class="setting-label">ðŸ“§ Email:</span>
                        <pre><code>PotatoSlicer18@protonmail.com</code></pre>
                    </div>
                </div>

                <div class="settings-section">
                    <h3 class="settings-title">ðŸ“„ License</h3>
                    <p class="card-description">MIT License â€” free to use, fork, modify, and share.</p>
                    <p class="card-description">A credit is appreciated but not required.</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Save Confirmation Message -->
    <div class="save-confirmation" id="saveConfirmationMessage">
        <svg viewBox="0 0 24 24">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
        </svg>
        <span>Settings saved successfully!</span>
    </div>

    <!-- Analytics Modal -->
    <div class="modal-overlay" id="analyticsModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Performance Analytics</h3>
                <button class="modal-close" onclick="hideModal('analyticsModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="skeleton skeleton-card"></div>
                <div class="skeleton skeleton-text medium"></div>
                <div class="skeleton skeleton-text short"></div>
                <div class="skeleton skeleton-text long"></div>
            </div>
        </div>
    </div>

    <!-- Custom Practice Modal -->
    <div class="modal-overlay" id="customModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Custom Practice Session</h3>
                <button class="modal-close" onclick="hideModal('customModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h4 class="settings-title">Session Configuration</h4>
                    <div class="setting-item">
                        <span class="setting-label">Number of Problems</span>
                        <span class="setting-control">25</span>
                    </div>
                    <div class="setting-item">
                        <span class="setting-label">Time Limit</span>
                        <span class="setting-control">5 minutes</span>
                    </div>
                    <div class="setting-item">
                        <span class="setting-label">Operations</span>
                        <span class="setting-control">All Enabled</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Training Modal -->
    <div class="modal-overlay" id="trainingModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="trainingModalTitle">Mental Math Training</h3>
                <button class="modal-close" onclick="requestEndSession()">Ã—</button>
            </div>
            <div class="modal-body">
                <!-- New Countdown Display -->
                <div id="countdownDisplay"></div>

                <div id="trainingProgress">
                    <div id="trainingProgressBar"></div>
                </div>
                <!-- Original timerDisplay is for timed practice countdown -->
                <div id="timerDisplay" style="display: none;">Time Left: 00:00</div>
                <!-- New stopwatch display -->
                <div id="stopwatchDisplay">0.0s</div> 
                <div id="problemCountDisplay">
                    Problem: <span id="currentProblemNumber">0</span> / <span id="totalProblems">0</span>
                    <span style="margin-left: 1rem;">Correct: <span id="correctScore" class="score-number correct">0</span></span>
                    <span>Incorrect: <span id="incorrectScore" class="score-number incorrect">0</span></span>
                </div>
                <div id="problemDisplay"></div>
                <!-- Container for input and repeat button -->
                <div class="answer-input-container">
                    <input type="number" id="answerInput" placeholder="Your Answer" autofocus>
                    <button id="repeatProblemBtn" class="repeat-problem-btn" title="Repeat Problem">
                        <div class="speaker"></div>
                    </button>
                </div>
                <div id="feedbackMessage"></div>
                <div id="trainingControls">
                    <button id="endSessionBtn">End Session</button>
                    <div id="endSessionConfirmation">
                        <p id="confirmationMessage">Are you sure you want to end this session? If you end it now, it will not be saved in your recent performance or counted toward your progress on the dashboard.</p>
                        <div id="confirmationButtons">
                            <button id="confirmEndBtn">Yes, End Session</button>
                            <button id="cancelEndBtn">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Summary Modal -->
    <div class="modal-overlay" id="summaryModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="summaryModalTitle">Practice Complete! ðŸŽ‰</h3>
                <button class="modal-close" onclick="hideModal('summaryModal')">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="summary-item">
                    <span class="summary-label">Correct Answers</span>
                    <span class="summary-value" id="summaryCorrect">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Incorrect Answers</span>
                    <span class="summary-value" id="summaryIncorrect">0</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Final Accuracy</span>
                    <span class="summary-value" id="summaryAccuracy">0%</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Time Elapsed</span>
                    <span class="summary-value" id="summaryTimeElapsed">00:00</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Avg. Time/Problem</span>
                    <span class="summary-value" id="summaryAvgTime">0.0s</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Link to external JavaScript file -->
    <script src="script.js"></script>
</body>
</html>
